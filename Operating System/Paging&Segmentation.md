# **메모리 단편화**

기억장치에서 메모리의 공간이 작은 조각으로 나뉘어져 사용가능한 메모리가 충분히 존재하지만 할당(사용)이 불가능한 상태

### **1. 내부 단편화**

- **partition의 크기가 프로세스의 크기보다 커서 메모리가 남지만, 다른 프로세스가 사용할 수 없는 상태**

 <img width="275" alt="image" src="https://github.com/2024-Computer-Science/2024-Computer-Science/assets/78026977/47d72ec7-7b62-43fa-8566-b270ce1cc603">

- 프로세스가 요청한 양보다 더 많은 메모리를 할당할 때 발생하며, 메모리 분할 자유 공간과 프로세스가 사용하는 공간의 크기 차이를 의미함

### **2. 외부 단편화**

- **남아 있는 메모리의 크기가 실행하고자 하는 프로세스보다 크지만, 연속적이지 않은 공간에 존재하여 실행하지 못하는 현상**

 <img width="477" alt="image" src="https://github.com/2024-Computer-Science/2024-Computer-Science/assets/78026977/69c99d73-f6ef-481c-8d29-f37109b8b12e">

- 메모리 할당 및 해제 작업의 반복으로 작은 메모리가 중간 중간 존재할 수 있음. 이렇게 사용하지 않는 메모리가 존재해서 총 메모리 공간은 충분하지만 실제로 할당할 수 없는 상황
- 외부 단편화를 해결하기 위해 압축을 이용하여 프로세스가 사용하는 공간을 한쪽으로 몰 수 있지만, 작업 효율이 좋지 않음

# 메모리 관리 기법

### 1. 등장 배경

다중 프로그래밍 시스템에 여러 프로세스를 수용하기 위해 주 기억장치를 동적 분할하는 메모리 관리작업이 필요함

### 2. 연속 메모리 관리

> 프로그램 전체가 메모리에 **연속적으로 할당**되는 기법
> 
- **고정 분할 기법**: 모든 파티션의 크기가 일정 → 내부 단편화 발생
- **동적 분할 기법**: 프로세스가 주기억장치로 적재될 때 필요한 크기만큼 메모리 할당, 파티션의 크기와 개수가 가변적 → 외부 단편화 발생

### 3. 불연속 메모리 관리

> 프로그램의 일부가 **서로 다른 주소 공간에 할당**될 수 있는 기법
> 

**📍 용어 정리** 

- **page**: 고정된 크기의 작은 프로세스 조각
- **frame**: 페이지 크기와 같은 주기억장치 메모리 조각
- **페이지 테이블**: 프로세스의 각 페이지에 해당하는 프레임 위치 관리
- **가상 메모리**: 실행하고자 하는 프로그램의 일부만 메모리에 적재하여 실제 물리 메모리 크기보다 큰 프로세스를 실행할 수 있게 하는 기술
    
    ### `Paging`
    
  
    - 프로세스를 페이지 단위로 자르고, 메모리를 프레임 단위로 잘라 페이지를 프레임에 할당하는 가상 메모리 관리 기법
    
    💡 프로세스를 이루는 페이지가 어느 프레임에 적재되어 있는지 CPU가 어떻게 관리해야하는가? (불연속 배치)
    ⇒ 페이지 테이블
    
    
    <img width="247" alt="image" src="https://github.com/2024-Computer-Science/2024-Computer-Science/assets/78026977/8f50f4fc-0a9f-4987-abfc-767da0043c07">

    - 페이지 번호와 프레임 번호를 짝지어 주는 일종의 이정표
    - 프로세스마다 존재함
    
    ### `Segmentation`
      
  <img width="440" alt="image" src="https://github.com/2024-Computer-Science/2024-Computer-Science/assets/78026977/3f6d0209-aebf-4020-a21d-4ca5027b65a5">

    - **segment**: 프로세스를 논리적 내용을 기반으로 나눠서 메모리에 배치, 가변 크기
    - 프로세스를 segment의 집합으로 만듦
    - **세그먼트 테이블**: 세그먼트 번호와 시작 주소(base), 세그먼트 크기(limit)를 엔트리로 가짐
    - CPU에서 해당 세그먼트의 크기를 넘어서는 주소가 들어오면 인터럽트가 발생해서 해당 프로세스를 강제 종료
    
    ### 정리
    
    | Paging | Segmentation |
    | --- | --- |
    | 고정 크기 | 가변 크기
    내부 단편화 발생 가능 | 외부 단편화 발생 가능 |
    페이지들의 크기가 프레임보다 큰 경우가 없기 때문에 메모리에 못들어가는 경우는 없다 → 외부 단편화X | 내부 단편화 발생 X |
