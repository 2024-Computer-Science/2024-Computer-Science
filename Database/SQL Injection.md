# SQL Injection

## SQL Injection

→ 응용 프로그램 보안 상의 허점을 의도적으로 이용해, 악의적인 SQL문을 실행되게 함으로써 데이터베이스를 비정상적으로 조작하는 코드 인젝션 공격 방법

## SQL 인젝션 공격 방법

### 1. 인증 우회

쿼리를 서버로 보낼 때, 일반적으로 보내야 하는 정보 이외에 다른 쿼리문을 함께 입력하여 개발자가 의도하지 않은 쿼리를 실행하게 하는 방법이다.

(ex. `‘1’ = ‘1’`과 같은 true만 반환하는 쿼리를 작성하여 인증을 우회하는 예제)

```jsx
// 일반적인 쿼리
SELECT * 
		FROM USER 
				WHERE ID = "abc" 
				AND PASSWORD = "1234";
```

```jsx
// 인증 우회 방식으로 공격하는 쿼리
SELECT * 
		FROM USER 
				WHERE ID = "abc" 
				AND PASSWORD = "1234"
				OR 1 = 1; // 무조건 TRUE값을 반환하는 쿼리 추가
```

### 2. 데이터 노출

시스템에서 발생하는 에러 메세지(Log)를 이용해 공격하는 방법.

해커들이 악의적으로 에러를 띄우는 쿼리를 삽입하여 에러 메세지(Log)를 띄우고, 이를 통해 DB의 구조를 유추할 수 있다.

---

## SQL 인젝션 방어 방법

1. 값을 입력받을 때 특수문자 여부 검사하기
    
    (로그인 전, 검증 로직을 미리 추가하여 특수문자가 들어온다면 요청을 무시한다.)
    
2. SQL 서버 오류 발생 시, 해당하는 에러 메세지 감추기
    
    (view를 활용하여 원본 DB의 접근 권한을 높여, 일반 사용자가 에러를 볼 수 없게 한다.)
    
3. preparestatement 사용하기

<aside>
💡 preparestatement란?
특수문자를 자동으로 escaping해주는 것… → 서버에서 필터링 과정 할 때 사용한다고 한다..

</aside>
