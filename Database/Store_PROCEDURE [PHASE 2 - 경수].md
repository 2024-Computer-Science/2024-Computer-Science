# Stored PROCEDURE

# 저장 프로시저 (Store PROCEDURE)

→ 일련의 쿼리를 마치 하나의 함수처럼 실행하기 위한 쿼리의 집합

![image](https://github.com/user-attachments/assets/0bbbc0b2-7d2b-4f09-8fb3-c15ef1fe00bb)


## 저장 프로시저의 장점

### 1. SQL Server의 성능을 향상시킬 수 있다.

저장 프로시저를 처음에 실행하면 최적화, 컴파일 단계를 거쳐 그 결과가 캐시(메모리)에 저장된다.

이후에 해당 SP를 실행하게 되면 캐시에 있는 것을 가져와 사용하므로 실행속도가 빨라진다.

### 2. 유지보수 및 재활용이 용이하다.

개발자가 SQL을 직접 건드리지 않고, SP 파일만 수정하면 되기 때문에 유지보수 측면에서 유리하다.

또한, 한 번 저장해놓은 프로시저를 언제든 호출하여 실행 가능하기 때문에 재활용 측면에서도 유리하다.

### 3. 보안을 강화할 수 있다.

사용자별로 테이블에 권한을 주는 것이 아닌, 저장 프로시저에 접근 권한을 부여하여 보안적인 측면에서 이점이 있다.

실제 테이블에 접근하여 다양한 조작을 하는 것은 위험하기 때문에 SP 권한만 부여하는 방식을 사용하면 좋다.

### 4. 네트워크의 부하를 줄일 수 있다.

클라이언트에서 서버로 쿼리의 모든 텍스트를 전송하는 것보다 저장 프로시저를 활용하면 저장프로시저의 구성 요소(이름, 매개변수, 등..)만 간단히 호출하는 것만으로 실행 가능하여 부하를 줄일 수 있다.

## 저장 프로시저의 단점

### 1. 성능

저장 프로시저는 실행할 때 최적화 단계를 수행하는데, 이 때, 인덱스를 사용할지 안할지 결정한다. 만약에 가져올 데이터가 많은데, 인덱스를 사용하면 오히려 성능에 악영향을 끼칠 수 있다.

또 문자, 숫자 연산에서 프로그래밍 언어인 C/Java 보다 성능이 느리다.

### 2. 호환성

구문 규칙이 SQL/PSM 표준과 호환성이 낮기 때문에 코드 자산으로의 재사용성이 나쁘다.

### 3. 디버깅

에러가 발생했을 때, 어디서 잘못됐는지 디버깅하는 것이 힘들 수 있다.

https://devkingdom.tistory.com/323
